<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡∏ô‡∏±‡∏ö‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏≠‡∏≠‡∏Å | Payday Countdown </title>
  <meta name="description" content="‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏ô‡∏±‡∏ö‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏ö‡∏ö‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞ ‡∏õ‡∏£‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠/‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏î‡πâ‡∏ú‡πà‡∏≤‡∏ô‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÉ‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå" />
  <style>
    :root{
      --bg:#0f172a; /* slate-900 */
      --card:#111827ee; /* gray-900 alpha */
      --text:#e5e7eb; /* gray-200 */
      --muted:#94a3b8; /* slate-400 */
      --accent:#22d3ee; /* cyan-400 */
      --accent-2:#a78bfa; /* violet-400 */
      --ok:#34d399; /* emerald-400 */
      --danger:#f87171; /* red-400 */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans Thai", "Noto Sans", Arial, "Helvetica Neue", "Sarabun", sans-serif;
      color:var(--text); background: radial-gradient(1200px 700px at 10% 10%, #1f2937 0%, var(--bg) 60%), radial-gradient(900px 600px at 90% 80%, #111827 0%, var(--bg) 60%);
      min-height:100%; display:flex; align-items:center; justify-content:center; padding:24px;
    }
    .wrap{ width:min(1100px, 96vw); }
    header{ display:flex; flex-direction:column; gap:10px; align-items:center; text-align:center; }
    h1{ font-size:clamp(24px, 3.6vw, 44px); margin:0; letter-spacing:0.3px; }
    .subtitle{ color:var(--muted); font-size:clamp(14px, 1.8vw, 16px); }

    .card{ background:linear-gradient(180deg, #0b1020aa, #0b1020aa), radial-gradient(1200px 600px at 50% -10%, #1f2937, transparent 60%);
      border:1px solid #1f2937; border-radius:24px; padding:28px; box-shadow:0 10px 30px rgba(0,0,0,.35);
    }

    .grid{ display:grid; grid-template-columns: repeat(4, minmax(0, 1fr)); gap:16px; margin-top:22px; }
    @media (max-width:720px){ .grid{ grid-template-columns:repeat(2, 1fr); } }

    .unit{ background:linear-gradient(180deg, #0b1228, #0b1020); border:1px solid #1f2937; border-radius:18px; padding:18px; text-align:center; }
    .num{ font-variant-numeric:tabular-nums; font-size:clamp(34px, 7.5vw, 80px); font-weight:800; line-height:1; }
    .label{ color:var(--muted); margin-top:8px; letter-spacing:.5px; text-transform:uppercase; font-size:12px; }

    .target{ margin-top:10px; color:var(--muted); font-size:14px; }

    .controls{ margin-top:20px; display:flex; flex-wrap:wrap; gap:10px; justify-content:center; }
    button, input, select{ font:inherit }
    .btn{ cursor:pointer; background:linear-gradient(90deg, var(--accent), var(--accent-2)); color:#0b1020; border:none; padding:10px 16px; border-radius:12px; font-weight:700; }
    .btn.secondary{ background:#111827; color:var(--text); border:1px solid #1f2937; }
    .btn:active{ transform:translateY(1px) }

    dialog{ border:none; border-radius:16px; background:#0b1228; color:var(--text); width:min(680px, 96vw); padding:0; box-shadow:0 20px 40px rgba(0,0,0,.45); }
    .dlg-head{ padding:18px 22px; border-bottom:1px solid #1f2937; display:flex; justify-content:space-between; align-items:center; }
    .dlg-body{ padding:18px 22px; }
    .row{ display:grid; grid-template-columns: 160px 1fr; gap:12px; align-items:center; margin:10px 0; }
    .row input, .row select{ width:100%; background:#0b1020; border:1px solid #1f2937; color:var(--text); padding:10px 12px; border-radius:10px; }
    .help{ color:var(--muted); font-size:13px }
    .footer{ display:flex; gap:10px; justify-content:flex-end; padding:18px 22px; border-top:1px solid #1f2937; }

    .done{ display:none; margin-top:18px; text-align:center; font-size:clamp(18px, 2.4vw, 26px); color:var(--ok); }
    .expired{ display:none; margin-top:18px; text-align:center; font-size:clamp(18px, 2.4vw, 26px); color:var(--danger); }

    .brand{ position:fixed; bottom:10px; right:14px; font-size:12px; color:#64748b }
    a{ color:var(--accent) }

    /* Fullscreen enhancements */
    .fs-fab{ display:none; position:fixed; top:16px; right:16px; z-index:60; }
    :fullscreen .fs-fab{ display:inline-flex; }
    :fullscreen .num{ font-size:clamp(44px, 10vw, 120px); }
    :fullscreen .wrap{ width:min(1400px, 98vw); }
    :fullscreen body{ padding:12px; }
    :fullscreen .brand{ display:none; }
    :fullscreen .controls{ position:fixed; left:50%; transform:translateX(-50%); bottom:calc(env(safe-area-inset-bottom, 0px) + 12px); z-index:55; background:#0b1020cc; backdrop-filter: blur(6px); border:1px solid #1f2937; border-radius:16px; padding:8px 10px; gap:8px; }
  </style>
</head>
<body>
  <main class="wrap">
    <header>
      <h1 id="title">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ô‡∏±‡∏ö‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏≠‡∏≠‡∏Å‚Ä¶üéâ</h1>
      <div class="subtitle">‡∏õ‡∏£‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠/‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏î‡πâ‡∏ú‡πà‡∏≤‡∏ô‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÉ‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏î ‚Äú‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‚Äù</div>
    </header>

    <section class="card">
      <div class="grid" role="timer" aria-live="polite">
        <div class="unit"><div class="num" id="d">‚Äî</div><div class="label">‡∏ß‡∏±‡∏ô</div></div>
        <div class="unit"><div class="num" id="h">‚Äî</div><div class="label">‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</div></div>
        <div class="unit"><div class="num" id="m">‚Äî</div><div class="label">‡∏ô‡∏≤‡∏ó‡∏µ</div></div>
        <div class="unit"><div class="num" id="s">‚Äî</div><div class="label">‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</div></div>
      </div>
      <div class="target" id="targetText"></div>
      <div class="done" id="doneMsg">‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏•‡πâ‡∏ß! üéâ</div>
      <div class="expired" id="expiredMsg">‡πÄ‡∏•‡∏¢‡πÄ‡∏ß‡∏•‡∏≤‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏∞‡∏Ñ‡∏∞ ‚Äî ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢</div>

      <div class="controls">
        <button class="btn" id="open">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
        <button class="btn secondary" id="fs" aria-pressed="false">‡πÄ‡∏ï‡πá‡∏°‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠</button>
        <button class="btn secondary" id="copy">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ</button>
      </div>
    </section>

    <!-- Floating Exit Fullscreen button (shows only in fullscreen) -->
    <button class="fs-fab btn secondary" id="fsFab" title="‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÄ‡∏ï‡πá‡∏°‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠" aria-label="‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÄ‡∏ï‡πá‡∏°‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠">‡∏≠‡∏≠‡∏Å‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠</button>

    <dialog id="dlg">
      <div class="dlg-head">
        <strong>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏Ñ‡∏≤‡∏ô‡∏ï‡πå‡∏î‡∏≤‡∏ß‡∏ô‡πå</strong>
        <button class="btn secondary" id="close">‡∏õ‡∏¥‡∏î</button>
      </div>
      <div class="dlg-body">
        <div class="row">
          <label for="inpTitle">‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏µ‡πÄ‡∏ß‡∏ô‡∏ï‡πå</label>
          <input id="inpTitle" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏™‡∏†‡∏≤ ‡∏≠‡∏ö‡∏ï. ‡∏™‡∏°‡∏±‡∏¢‡∏™‡∏≤‡∏°‡∏±‡∏ç ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà 4/2568" />
        </div>
        <div class="row">
          <label for="inpDate">‡∏ß‡∏±‡∏ô-‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</label>
          <input id="inpDate" type="datetime-local" />
        </div>
        <div class="row">
          <label for="inpTZ">‡πÄ‡∏Ç‡∏ï‡πÄ‡∏ß‡∏•‡∏≤ (TZ)</label>
          <select id="inpTZ"></select>
        </div>
        <div class="row">
          <label for="inpBg">‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á</label>
          <select id="inpBg">
            <option value="default">‡πÑ‡∏•‡πà‡∏™‡∏µ‡πÄ‡∏Ç‡πâ‡∏° (‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô)</option>
            <option value="plain">‡∏™‡∏µ‡πÄ‡∏Ç‡πâ‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö</option>
            <option value="stars">‡∏ó‡πâ‡∏≠‡∏á‡∏ü‡πâ‡∏≤‡∏î‡∏≤‡∏ß</option>
          </select>
        </div>
        <p class="help">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏ä‡∏£‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡πÄ‡∏ä‡πà‡∏ô <code>?t=2025-09-30T09:00:00%2B07:00&title=‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏™‡∏†‡∏≤&tz=Asia/Bangkok&bg=stars</code></p>
      </div>
      <div class="footer">
        <button class="btn secondary" id="preview">‡∏û‡∏£‡∏µ‡∏ß‡∏¥‡∏ß</button>
        <button class="btn" id="save">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå</button>
      </div>
    </dialog>

  </main>
  <div class="brand">Countdown </div>

  <script>
    // ----- Utilities -----
    const qs = new URLSearchParams(location.search);
    const $ = (id)=>document.getElementById(id);

    // Timezone list (short curated)
    const TZ_LIST = [
      "Asia/Bangkok","Asia/Ho_Chi_Minh","Asia/Jakarta","Asia/Singapore","Asia/Tokyo","Asia/Seoul",
      "Asia/Shanghai","Asia/Taipei","Asia/Kuala_Lumpur","Asia/Yangon","Europe/London","Europe/Paris",
      "America/New_York","America/Los_Angeles","Australia/Sydney"
    ];

    // Background variants
    function applyBG(mode){
      if(mode === 'plain'){
        document.body.style.background = '#0b1020';
      } else if(mode === 'stars'){
        const svg = encodeURIComponent(`<?xml version='1.0'?>
<svg xmlns='http://www.w3.org/2000/svg' width='160' height='160'>
<rect width='100%' height='100%' fill='#0b1020'/>
<g fill='#223150'>
<circle cx='10' cy='20' r='1.2'/>
<circle cx='35' cy='60' r='1'/>
<circle cx='90' cy='45' r='1.1'/>
<circle cx='120' cy='100' r='1.3'/>
<circle cx='150' cy='20' r='1'/>
<circle cx='60' cy='130' r='1.1'/>
</g>
</svg>`);
        document.body.style.background = `#0b1020 url("data:image/svg+xml,${svg}") center/160px repeat`;
      } else {
        document.body.style.background = 'radial-gradient(1200px 700px at 10% 10%, #1f2937 0%, var(--bg) 60%), radial-gradient(900px 600px at 90% 80%, #111827 0%, var(--bg) 60%)';
      }
    }

    // Parse params
    const title = qs.get('title') || '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ô‡∏±‡∏ö‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏≠‡∏≠‡∏Å‚Ä¶';
    const tParam = qs.get('t'); // ISO with timezone preferred
    const tzParam = qs.get('tz') || 'Asia/Bangkok';
    const bgParam = qs.get('bg') || 'default';
    const redirect = qs.get('redirect');

    applyBG(bgParam);

    // Target time handling
    let target = null;
    if(tParam){
      // Accept ISO or epoch seconds/millis
      if(/^[0-9]+$/.test(tParam)){
        const n = Number(tParam);
        target = new Date(n > 1e12 ? n : n*1000);
      } else {
        target = new Date(tParam);
      }
    }

    // Fallback: 24h from now in Asia/Bangkok
    if(!target || isNaN(target.getTime())){
      target = new Date(Date.now() + 24*60*60*1000);
    }

    // Fill title
    document.title = title + ' | Countdown';
    document.querySelector('h1#title').textContent = title;

    // Display target text using requested TZ
    function fmtTarget(dt, tz){
      try{
        const f = new Intl.DateTimeFormat('th-TH', { dateStyle:'full', timeStyle:'medium', timeZone: tz });
        return `‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤: ${f.format(dt)} (${tz})`;
      }catch(e){
        const f2 = new Intl.DateTimeFormat('th-TH', { dateStyle:'full', timeStyle:'medium' });
        return `‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤: ${f2.format(dt)}`;
      }
    }
    document.getElementById('targetText').textContent = fmtTarget(target, tzParam);

    // ----- Ticker -----
    let done = false;
    const tick = ()=>{
      const now = new Date();
      const diff = target.getTime() - now.getTime();
      if(diff <= 0){
        if(!done){
          done = true;
          document.getElementById('doneMsg').style.display = 'block';
          document.getElementById('expiredMsg').style.display = 'none';
          if(redirect){ setTimeout(()=> location.href = redirect, 1500); }
        }
        document.getElementById('d').textContent = '0';
        document.getElementById('h').textContent = '0';
        document.getElementById('m').textContent = '0';
        document.getElementById('s').textContent = '0';
        return;
      }
      const totalSeconds = Math.floor(diff/1000);
      const days = Math.floor(totalSeconds / 86400);
      const hours = Math.floor((totalSeconds % 86400)/3600);
      const mins = Math.floor((totalSeconds % 3600)/60);
      const secs = totalSeconds % 60;
      document.getElementById('d').textContent = days;
      document.getElementById('h').textContent = hours.toString().padStart(2,'0');
      document.getElementById('m').textContent = mins.toString().padStart(2,'0');
      document.getElementById('s').textContent = secs.toString().padStart(2,'0');
    };
    tick();
    setInterval(tick, 250);

    // ----- Dialog setup -----
    const dlg = document.getElementById('dlg');
    const tzSel = document.getElementById('inpTZ');
    TZ_LIST.forEach(z=>{ const o=document.createElement('option'); o.value=z; o.textContent=z; tzSel.appendChild(o); });
    tzSel.value = tzParam;

    // Prefill inputs
    document.getElementById('inpTitle').value = title;
    // to datetime-local (no timezone) using local time of browser
    const toLocalDT = (d)=>{
      const pad = (n)=> String(n).padStart(2,'0');
      return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}T${pad(d.getHours())}:${pad(d.getMinutes())}`;
    };
    document.getElementById('inpDate').value = toLocalDT(target);
    document.getElementById('inpBg').value = bgParam;

    document.getElementById('open').addEventListener('click', ()=> dlg.showModal());
    document.getElementById('close').addEventListener('click', ()=> dlg.close());
    document.getElementById('preview').addEventListener('click', ()=>{
      // Apply without changing URL
      const t = new Date(document.getElementById('inpDate').value);
      const tz = document.getElementById('inpTZ').value || 'Asia/Bangkok';
      const ttl = document.getElementById('inpTitle').value || '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ô‡∏±‡∏ö‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏≠‡∏≠‡∏Å‚Ä¶';
      const bg = document.getElementById('inpBg').value || 'default';
      document.querySelector('h1#title').textContent = ttl;
      document.getElementById('targetText').textContent = fmtTarget(t, tz);
      applyBG(bg);
      target = t;
      done = false;
      document.getElementById('doneMsg').style.display = 'none';
      document.getElementById('expiredMsg').style.display = 'none';
    });

    document.getElementById('save').addEventListener('click', ()=>{
      const t = new Date(document.getElementById('inpDate').value);
      const tz = document.getElementById('inpTZ').value || 'Asia/Bangkok';
      const ttl = document.getElementById('inpTitle').value || '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ô‡∏±‡∏ö‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏≠‡∏≠‡∏Å‚Ä¶';
      const bg = document.getElementById('inpBg').value || 'default';
      const iso = t.toISOString(); // UTC
      const paramT = encodeURIComponent(iso);
      const url = `${location.origin}${location.pathname}?t=${paramT}&title=${encodeURIComponent(ttl)}&tz=${encodeURIComponent(tz)}&bg=${encodeURIComponent(bg)}`;
      history.replaceState(null, '', url);
      navigator.clipboard?.writeText(url);
      document.getElementById('targetText').textContent = fmtTarget(t, tz);
      document.querySelector('h1#title').textContent = ttl;
      applyBG(bg);
      target = t; done=false; document.getElementById('doneMsg').style.display='none';
      dlg.close();
      alert('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏•‡∏∞‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞ ‚ú®');
    });

    document.getElementById('copy').addEventListener('click',()=>{
      navigator.clipboard?.writeText(location.href);
      alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞');
    });

    // ----- Fullscreen: robust controls visibility -----
    (function(){
      const fsBtn = document.getElementById('fs');
      const fsFab = document.getElementById('fsFab');
      function isFS(){ return document.fullscreenElement || document.webkitFullscreenElement || document.msFullscreenElement; }
      async function enterFS(el=document.documentElement){
        try{
          if(el.requestFullscreen) await el.requestFullscreen();
          else if(el.webkitRequestFullscreen) el.webkitRequestFullscreen();
          else if(el.msRequestFullscreen) el.msRequestFullscreen();
        }catch(e){ console.warn(e); alert('‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ö‡∏•‡πá‡∏≠‡∏Å‡πÇ‡∏´‡∏°‡∏î‡πÄ‡∏ï‡πá‡∏°‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á'); }
      }
      function exitFS(){
        if(document.exitFullscreen) document.exitFullscreen();
        else if(document.webkitExitFullscreen) document.webkitExitFullscreen();
        else if(document.msExitFullscreen) document.msExitFullscreen();
      }
      function updateBtn(){
        if(!fsBtn) return;
        const on = !!isFS();
        fsBtn.textContent = on ? '‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÄ‡∏ï‡πá‡∏°‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠' : '‡πÄ‡∏ï‡πá‡∏°‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠';
        fsBtn.setAttribute('aria-pressed', on ? 'true' : 'false');
      }
      if(fsBtn){ fsBtn.addEventListener('click', ()=> isFS() ? exitFS() : enterFS()); }
      if(fsFab){ fsFab.addEventListener('click', exitFS); }
      document.addEventListener('fullscreenchange', updateBtn);
      document.addEventListener('webkitfullscreenchange', updateBtn);
      document.addEventListener('keydown', (e)=>{
        if(e.key && e.key.toLowerCase() === 'f'){ e.preventDefault(); isFS() ? exitFS() : enterFS(); }
        if(e.key === 'Escape'){ setTimeout(updateBtn,0); }
      });
      // Auto arm via ?fs=1
      const autoFS = (new URLSearchParams(location.search)).get('fs');
      if(autoFS === '1' || autoFS === 'true'){
        const arm = ()=>{ enterFS(); window.removeEventListener('pointerdown', arm); window.removeEventListener('keydown', arm); };
        window.addEventListener('pointerdown', arm, { once:true });
        window.addEventListener('keydown', arm, { once:true });
      }
      updateBtn();
    })();
  </script>
</body>
</html>
